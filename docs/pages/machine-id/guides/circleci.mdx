---
title: Using Machine ID With Circle CI
description: A tutorial for using Machine ID with CircleCI
---

<Details
  title="Version warning"
  opened={true}
  scope={["oss", "enterprise"]}
  scopeOnly={true}
  min="11.0"
>
  Machine ID for CircleCI is available starting from Teleport `v11.1`.
</Details>

## Prerequisites

(!docs/pages/includes/edition-prereqs-tabs.mdx!)

- A node that is a part of the Teleport cluster with
[Server Access](https://goteleport.com/docs/server-access/introduction/).
- A local workstation with `tsh` access to the cluster.
- A CircleCI project connected to a Git repository you can push to.

## Step 1/4. Determine CircleCI IDs

## Step 2/4. Create the join token for CircleCI

```yaml
kind: token
version: v2
metadata:
  name: circleci-token
  expires: "2100-01-01T00:00:00Z"
spec:
  roles: [Bot]
  join_method: circleci
  bot_name: circleci-demo
  circleci:
    organization_id: 00f45056-5918-4171-9222-b538c76ed3f8
    allow:
      - project_id: dabad1c2-62eb-48a6-87ab-fc6ae6589281
```

## Step 3/4. Create a Machine ID bot

## Step 4/4. Configure CircleCI workflow

```yaml
# See: https://circleci.com/docs/2.0/configuration-reference
version: 2.1
jobs:
  teleport:
    docker:
      - image: cimg/base:stable
    steps:
      - checkout
      - run:
          name: "teleport"
          command: |
            ./tbot start --auth-server=root.tele.ottr.sh:443 --join-method=circleci --token=circleci-token --oneshot --destination-dir=./certs --data-dir=./data
            ./tsh -i ./certs/identity --proxy root.tele.ottr.sh:443 ssh noahstride@noah-laptop "echo $CIRCLE_BUILD_URL >> ~/circle_run_log"
workflows:
  teleport-workflow:
    jobs:
      - teleport:
          context:
            - test-context
```

## Further steps

### Using CircleCI contexts
